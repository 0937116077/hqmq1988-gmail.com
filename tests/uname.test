#!/bin/sh

# Check uname syscall decoding.

. "${srcdir=.}/init.sh"

check_prog uniq

OUT="$LOG.out"
EXP="$LOG.exp"

run_prog > /dev/null
run_strace -v -euname $args > "$EXP"
uniq < "$LOG" > "$OUT"

run_prog "./${ME_%.test}" abbrev > /dev/null
run_strace -euname $args >> "$EXP"
uniq < "$LOG" >> "$OUT"

match_diff "$OUT" "$EXP"
rm -f "$OUT" "$EXP"
