#!/bin/sh

# Check select/pselect6 syscall decoding.

. "${srcdir=.}/init.sh"

exe="./${ME_%.test}"
syscall=select
run_prog "$exe" $syscall > /dev/null
run_strace $args > /dev/null

check_prog grep
if LC_ALL=C grep -x "pselect6(.*" "$LOG" > /dev/null; then
	syscall=pselect6
	run_prog "$exe" $syscall > /dev/null
fi

OUT="$LOG.out"
run_strace -a36 -e$syscall $args > "$OUT"
match_diff "$OUT" "$LOG"
rm -f "$OUT"

exit 0
